<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
    xmlns:pm="http://primefaces.org/mobile" 
    xmlns:fn="http://java.sun.com/jsp/jstl/functions"         
    contentType="text/html" renderKitId="PRIMEFACES_MOBILE">
  <f:view>    
  <pm:page>
   <pm:view>
		<ui:include src="../../pages/common//headerScript.xhtml"></ui:include>
		
		<script type="text/javascript">$(document).ready(function(){if($("#ui-table-1 tr th:first").length>0){$("#ui-table-1 tr th:first").attr("class","").html("")}$("#form\\:ridePreMatchTest").val("1");var a=[];var b=[];var c=new Array();$("#form [id^=form\\:member_data] tr").each(function(){var e=$(this).find("td:nth-child(2) span:first").html().trim();var d=$(this).find("td:last input:nth-child(4)").val().trim();if(e.length!=0){if(!($.inArray(e,c)>-1)){c.push(e);a[e]=1}if(b[e]===undefined){b[e]=1}else{b[e]+=1}}});$("#form [id^=form\\:member_data] tr").each(function(){var d=$(this).find("td:nth-child(2) span:first").html().trim();if(a[d]==1){a[d]=0}else{if(d.length!=0){$(this).hide();$(this).find("td:eq(1) span:eq(1)").hide();$(this).find("td:eq(1) div:eq(0)").hide()}}});$("#form [id^=form\\:member_data] tr").each(function(){var d=$(this).find("td:nth-child(2) span:first").html().trim();if(b[d]==1){$(this).find("td:nth-child(2) span:eq(1)").hide()}});xhr3()});function contains(d,b){for(var c=b.length-1;c>=0;c--){if(b[c]==d){return true}}return false}function linkingTest(){var d=[];$("#form select[id^=form\\:member]").each(function(){var i=$(this).parent().parent().index();var h=$(this).find(":selected").val();if($(this).parent().parent().find("td:first").find(".ui-chkbox-box").hasClass("ui-state-active")){d[i]=h}});var a={};$("#form [id^=form\\:member_data] tr").each(function(){var h=$(this).find("td:nth-child(2) span:first").html().trim();if(a[h]===undefined){a[h]=$(this).index()}});if(d.length==0){alert("select a ride to link");return false}for(var c in d){var f=$("#form\\:member_data tr:eq("+c+")").find("td:eq(1) span:eq(0)").text().trim();var e=a[f];var g=$("#group_status").val();var b=g.split(",");if(e!=c){if(!($.inArray(e,b)>-1)){continue}}if(d[c]==parseInt(d[c])){if(0>parseInt(d[c])){alert("Select vehicle before linking.");return false}}else{alert("Select vehicle before linking.");return false}}return true}function xhr3(){$("#form\\:ridePreMatchTest").val("1");var a=[];var d=[];var f=new Array();$("#form [id^=form\\:member_data] tr").each(function(){var h=$(this).find("td:nth-child(2) span:first").html().trim();var g=$(this).find("td:last input:nth-child(4)").val().trim();if(h.length!=0){if(!($.inArray(h,f)>-1)){f.push(h);a[h]=1}if(d[h]===undefined){d[h]=1}else{d[h]+=1}}});$("#form [id^=form\\:member_data] tr").each(function(){var g=$(this).find("td:nth-child(2) span:first").html().trim();if(a[g]==1){a[g]=0}else{if(g.length!=0){$(this).find("td:eq(1) span:eq(1)").hide();$(this).find("td:eq(1) div:eq(0)").hide()}}});$("#form [id^=form\\:member_data] tr").each(function(){var g=$(this).find("td:nth-child(2) span:first").html().trim();if(d[g]==1){$(this).find("td:nth-child(2) span:eq(1)").hide()}});var e=$("#group_status").val();if(e.length>1){e=e.substring(0,e.length-1)}var c=e.split(",");if(c.length>0){for(var b in c){if(c[b]!=""){if(parseInt(c[b])==c[b]){$("#form\\:member_data tr:eq("+c[b]+")").find("td:eq(1) input[type=checkbox]").attr("checked",true);toggleGroup(c[b])}}}}}function xhr2(){var c=[];$("#form select[id^=form\\:member]").each(function(){var g=$(this).parent().parent().index()+1;var f=$(this).find(":selected").val();var e=$(this).parent().parent().find("td:last").find("input:first").val();if(parseInt(f)>0){if(c[f]==undefined||e>parseInt(c[f])){c[f]=e}}});var b=[];var d=new Array();$("#form [id^=form\\:member_data] tr").each(function(){var f=$(this).find("td:nth-child(2) span:first").html().trim();var e=$(this).find("td:last input:nth-child(4)").val().trim();if(f.length!=0){if(!($.inArray(f,d)>-1)){d.push(f);b[f]=e}}});var a={};$("#form [id^=form\\:member_data] tr").each(function(){var e=$(this).find("td:nth-child(2) span:first").html().trim();if(a[e]===undefined){a[e]=$(this).index()}});$("#form select[id^=form\\:member]").each(function(){var k=$("#group_status").val();if(k.length>1){k=k.substring(0,k.length-1)}var h=k.split(",");var l=$(this).parent().parent().index()+1;var g=$(this).find(":selected").val();var f=$(this).parent().parent().find("td:last").find("input:first").val();var i=1;var j=$(this).parent().parent().find("td:nth-child(2) span:first").html().trim();if(contains(a[j],h)){var e=$(this).parent().parent().find("td:nth-child(2) span:first").html().trim();if(b[e]!=undefined){if(b[e]!=null){i=b[e]}}}if(c[g]>i-1){$(this).parent().parent().find("td:last").find("span").html(c[g]-i+1);$(this).parent().parent().find("td:last").find("input:nth-child(2)").val(c[g]-i+1);c[g]=c[g]-i;if(0>c[g]){c[g]=0}}else{if(i>=c[g]){$(this).parent().parent().find("td:last").find("span").html("Seat Full");$(this).parent().parent().find("td:last").find("input:nth-child(2)").val(0);$(this).parent().parent().find("td:first").find("input[type=checkbox]").attr("disabled",true);$(this).parent().parent().find("td:first").find("span").attr("class","")}}});$("#form select[id^=form\\:member]").each(function(f){var e=$(this).find("option:selected").val().trim();if(e.length>0){$(this).parent().parent().find("td:last").find("span").html($(this).parent().parent().find("td:last").find("input:first").val());return false}})}function xr1(){var a=1000;var b=0;$("#form select[id^=form\\:member]").each(function(){var e=$(this).parent().parent().index()+1;var d=$(this).find(":selected").val();var c=$(this).parent().parent().find("td:last").find("input").val();if(d==($("#link_count_value").val())){b++;if(a>c){a=c}}});$("#form select[id^=form\\:member]").each(function(){var e=$(this).parent().parent().index()+1;var d=$(this).find(":selected").val();var c=$(this).parent().parent().find("td:last").find("input").val();if(e==($("#link_count_number").val())){if(d==($("#link_count_value").val())){if(b>1){$(this).parent().parent().find("td:last").find("input").val(a-1);$(this).parent().parent().find("td:last").find("span").html(a-1);if(1>$(this).parent().parent().find("td:last").find("input").val()){$(this).parent().parent().find("td:first").find("input[type=checkbox]").attr("disabled",true)}}}}})}function toggleScreen(e){var b=$("#form\\:member_data tr:eq("+e+")").find("td:eq(1) span:eq(0)").text().trim();var d=$("#form\\:member_data tr:eq("+e+")").find("td:eq(1) span:eq(1)").text().trim();if(d=="-"){for(var c=0;;c++){if(c==e){continue}if($("#form\\:member_data tr:eq("+c+")").html()===undefined){break}var a=$("#form\\:member_data tr:eq("+c+")").find("td:eq(1) span:eq(0)").text().trim();if(a===b){$("#form\\:member_data tr:eq("+c+")").hide()}}$("#form\\:member_data tr:eq("+e+")").find("td:eq(1) span:eq(1)").html("+").css("color","#4BAAD3")}else{for(var c=0;;c++){if(c==e){continue}if($("#form\\:member_data tr:eq("+c+")").html()===undefined){break}var a=$("#form\\:member_data tr:eq("+c+")").find("td:eq(1) span:eq(0)").text();if(a===b){$("#form\\:member_data tr:eq("+c+")").show()}}$("#form\\:member_data tr:eq("+e+")").find("td:eq(1) span:eq(1)").html("-").css("color","red")}}function collapseScreen(e){var b=$("#form\\:member_data tr:eq("+e+")").find("td:eq(1) span:eq(0)").text().trim();var d=$("#form\\:member_data tr:eq("+e+")").find("td:eq(1) span:eq(1)").text().trim();for(var c=0;;c++){if(c==e){continue}if($("#form\\:member_data tr:eq("+c+")").html()===undefined){break}var a=$("#form\\:member_data tr:eq("+c+")").find("td:eq(1) span:eq(0)").text().trim();if(a===b){$("#form\\:member_data tr:eq("+c+")").hide()}}$("#form\\:member_data tr:eq("+e+")").find("td:eq(1) span:eq(1)").html("+").css("color","#4BAAD3")}function toggleGroup(e){var b=$("#form\\:member_data tr:eq("+e+")").find("td:eq(1) span:eq(0)").text().trim();var d=$("#form\\:member_data tr:eq("+e+")").find("td:eq(1) input[type=checkbox]").is(":checked");if(d){collapseScreen(e)}$("#group_status").val("");for(var c=0;;c++){if($("#form\\:member_data tr:eq("+c+")").html()===undefined){break}var a=$("#form\\:member_data tr:eq("+c+")").find("td:eq(1) span:eq(0)").text().trim();if(a===b){if(d){matches.selectRow(c,true);$("#form\\:member_data tr:eq("+c+")").find("td:eq(1) input[type=checkbox]").prop("checked",true)}else{matches.unselectRow(c,true);$("#form\\:member_data tr:eq("+c+")").find("td:eq(1) input[type=checkbox]").prop("checked",false)}}if($("#form\\:member_data tr:eq("+c+")").find("td:eq(1) div").css("display")!="none"){if($("#form\\:member_data tr:eq("+c+")").find("td:eq(1) input[type=checkbox]").is(":checked")){$("#group_status").val($("#group_status").val()+""+c+",")}}}}function updateVehicleDatePicker(){$("#vehicleTab\\:vehicleDate").val(new Date().format("d NNN yyyy")).datepicker({dateFormat:"d M yy",minDate:new Date()})};</script>
		
<h:head></h:head>
<h:body>
	<ui:include src="../../pages/common/headerContent.xhtml"></ui:include>
	<script type="text/javascript" src="../../resources/js/bootstrap-tooltip.js"></script>
	<script type="text/javascript">jQuery(document).ready(function(){$("[data-toggle='tooltip']").tooltip({trigger:"hover focus",delay:{show:500,hide:100}});updateVehicleDatePicker()});</script>
  <!-- Start: MAIN CONTENT -->
  <div class="content">
    <div class="container">
      <div class="row">
        <div class="span2">

          <div class="smv-leftnav">
            
          	<!-- Include leftPanel.xhtml -->
          	<ui:include src="../../pages/common/leftPanel.xhtml"></ui:include>
          </div>
        </div>
        <!-- table section -->
        <div class="span10">
          <div class="page-header">
            <h1>Trip Selection </h1>
          </div>
          <div class="row">
            <div class="span10">
                        
               <h:outputText rendered="#{userAction.allCircleForLoginUserList == null and (sessionScope.user_role == 'C' || sessionScope.user_role == 'P' || sessionScope.user_role == 'B')}"></h:outputText>
                            
			<c:choose>  
				<c:when test="#{userAction.allCircleForLoginUserList != null and sessionScope.user_role == 'T'}">
          <!-- auto taxi selection -->
          
         
          <pm:content rendered="#{empty userAction.allAffiliateCircleForTaxiUser}">
          <span class="span10 muted lead"><h3><h:outputText value="You are not affiliated with any circle."></h:outputText></h3></span>
          </pm:content>
          
           <pm:content rendered="#{not empty userAction.allAffiliateCircleForTaxiUser}">
              	
              	<pm:content rendered="${!userAction.ridePreMatchFormTest}">
          		${userAction.clearMatchTripList()}
          		</pm:content>
      		
        		<pm:content>
        			<h:form id="vehicleTab" styleClass="navbar-form navbar-left">
        				<div class="form-group">
        				<span class="muted lead" style="float:left"> Vehicles for date &nbsp;</span>
        				<h:inputText value="#{userAction.ridePreVehicleDate}" id="vehicleDate" style="width:100px;float:left" styleClass="form-control"/> &nbsp;
        				<span class="modal-link-span-3">
        				<h:commandLink value="Show Vehicles" styleClass="btn btn-success" style="float:left;clear:both;margin: 5px auto auto -23px;">
        					 <f:param value="#{userAction.ridePreVehicleDate}" name="vehicleDate"></f:param>
        					 <p:ajax update="@form,:modalPanel-3-panel" oncomplete="modalUpdate();updateDataTable();updateVehicleDatePicker();" listener="#{userAction.populateVehicleByDate}" process="@this,vehicleDate"/>
        				</h:commandLink>
        				</span>
        				</div>
        			</h:form>
        		</pm:content>
        		  		
              	<pm:content>
              	<h:form styleClass="form-inline">
	               	<h:inputText id="from" value="#{userAction.rideSeekerDTO.fromAddress1}" style="width:180px;"></h:inputText> &nbsp;
	               	<p:watermark for="from" value="From"></p:watermark>
	               	<h:inputText id="to" value="#{userAction.rideSeekerDTO.toAddress1}" style="width:180px;"></h:inputText> &nbsp;
	               	<p:watermark for="to" value="To"></p:watermark>
	               	<p:calendar id="calendar" value="#{userAction.rideSeekerDTO.startDate}" pattern="dd MMM yyyy"/>
	               	<p:watermark for="calendar" value="Date"></p:watermark> &nbsp;
	               	<h:selectOneMenu id="taxiCircle" rendered="#{not empty userAction.allAffiliateCircleForTaxiUser and sessionScope.user_role == 'T'}" value="#{userAction.circleDTO.circleID}" style="height: 30px;;width: 150px;">
	               		<f:selectItem itemLabel="Affiliated Circles"></f:selectItem>
						<f:selectItems value="#{userAction.allAffiliateCircleForTaxiUser}"/>
					</h:selectOneMenu> &nbsp;
	             	<h:commandLink onclick="if(!$(this).parent().find('select:last').val() > 0) { alert('Please Select affiliated circle.'); return false; }" styleClass="btn btn-info" value="Search" action="#{userAction.rideMatchedTripListByCondition}" />
             	</h:form> 
             	</pm:content>
             
             ${userAction.clearScreenMessage()}
             <p:panel id="messagePanel" style="border:none;margin-left: -18px;margin-right: -18px;">			
			<c:forEach var="sucMessage" items="${userAction.successMessage}">
					<div class="alert fade in alert-success" syle="display:none;">
						<button class="close" data-dismiss="alert" type="button">×</button>
						<span class="form-message">${sucMessage}</span>
					</div>
			</c:forEach>
			<c:forEach var="errMessage" items="${userAction.errorMessage}">
					<div class="alert fade in alert-error" syle="display:none;">
						<button class="close" data-dismiss="alert" type="button">×</button>
						<span class="form-message">${errMessage}</span>
					</div>
			</c:forEach>
			${userAction.clearScreenMessage()}
			</p:panel>	
			
              <!-- auto taxi ends here -->
              <div class="">
              <pm:content>
				<input type="hidden" value="0" id="link_count_number"/>
				<input type="hidden" value="0" id="link_count_value"/>
				<input type="hidden" value="" id="group_status"/>
				
              <div id="ui-table-1">
              	<h:form styleClass="form-inline" id="form">
				<h:outputText value="Matched Trips" styleClass="muted" style="font-size:25px;font-weight:bold;margin:10px 4px;display:block;" rendered="#{not empty userAction.matchedTripByConditionList}"></h:outputText>
				<h:outputText value="No Matched Trips found" styleClass="muted" style="font-size:25px;font-weight:bold;margin:10px 4px;display:block;" rendered="#{empty userAction.matchedTripByConditionList and userAction.ridePreMatchFormTest}"></h:outputText>
				
				${userAction.makeRidePreMatchInactive()}
              
              <p:dataTable rowKey="#{tripList}" id="member" styleClass="table table-bordered table-striped" value="#{userAction.matchedTripDataModel}" var="tripList"
                 rendered="#{not empty userAction.matchedTripByConditionList}"  selection="#{userAction.matchedTripDTOs}" rowIndexVar="row" widgetVar="matches">
               <p:ajax event="rowSelectCheckbox" process="@this" />
               <f:param name="rideID" value="#{tripList.rideId}"></f:param>
               <f:param name="startDate" value="#{tripList.startDate}"></f:param>
               <p:ajax event="rowUnselectCheckbox" process="@this"/>
               <p:ajax event="toggleSelect" process="@this"/>
              <p:column headerText="Select" selectionMode="multiple" style="width:2%"/> 
             
               <p:column headerText="Group Id" style="width:14%">
               		<span><h:outputText value="#{tripList.groupId}" /></span>
               		<span class="toggle-group" style="display:inline;float:right;font-weight:bold;color:#4BAAD3;" onclick="toggleScreen('#{row}');">+</span>
               		<pm:content rendered="${not empty tripList.groupId}">(<span>${tripList.memberCount}</span>)</pm:content>
               		<pm:content rendered="${empty tripList.groupId}"><span></span></pm:content>
               		<pm:content rendered="${tripList.memberCount gt 1}">
               			<div style="float:left;font-family:monospace;font-size:0.7em;font-weight:bold;width:100%;">Select All <h:selectBooleanCheckbox onchange="toggleGroup('#{row}');" style="float:right;margin-top: 2px;" value="#{tripList.selectGroup}"/></div>
               		</pm:content>
               </p:column>
             <p:column headerText="Ride Id" style="width:2%">
             	<span class="modal-link-span-1">
              	<p:commandLink value="#{tripList.rideId}" rendered="#{tripList.rideId != 'NEW'}" action="#{userAction.showAllRideSeekerForRideInPopup}" oncomplete="modalUpdate();updateDataTable();return false;" update=":modalPanel-1-panel" >
              	<f:param name="rideID" value="#{tripList.rideId}"></f:param>
              	</p:commandLink>
              	</span>
              	<h:outputText value="#{tripList.rideId}" rendered="#{tripList.rideId == 'NEW'}"></h:outputText>
              </p:column>
              <p:column headerText="Requester" style="width:14%">
              <h:outputText value="#{tripList.userName}" /><h:outputText value=",#{tripList.companyName}" />
              </p:column>
              <p:column headerText="From" sortBy="startPoint" style="width:22%">
              <span data-toggle="tooltip" title="${tripList.startPoint}">${(fn:length(tripList.startPoint) > 15) ? fn:substring(tripList.startPoint, 0, 15) : tripList.startPoint} ${(fn:length(tripList.startPoint) > 15) ? '...' : ''}</span>
              </p:column>
              <p:column headerText="To" sortBy="endPoint" style="width:22%">
              <span data-toggle="tooltip" title="${tripList.endPoint}">${(fn:length(tripList.endPoint) > 15) ? fn:substring(tripList.endPoint, 0, 15) : tripList.endPoint} ${(fn:length(tripList.endPoint) > 15) ? '...' : ''}</span>
              </p:column>
              <p:column headerText="Date Time" sortBy="startDate" style="width:13%">
              <h:outputText value="#{tripList.startDate}"></h:outputText>
              </p:column>
              
              <p:column headerText="Vehicle Name" style="width:10%">
              
              <h:selectOneMenu style="width:auto" value="#{tripList.vehicleID}" onchange="$('#link_count_value').val($(this).find(':selected').val());$('#link_count_number').val($(this).parent().parent().index() + 1);">
               <f:selectItem itemLabel="Select Vehicle"></f:selectItem>
                <f:selectItems value="#{userAction.allVehicleList}"></f:selectItems>
<p:ajax oncomplete="
xhr2();xhr3();
$('#modalid2').find('a').attr('data-toggle', 'modal');
$('#modalid2').find('a').attr('href', '#modalPanel-2');
if($('#modalid2').find('a').length > 0) {
$('#modalPanel-2').attr('class', 'modal hide fade in').show();
$('#x1').attr('class', 'modal-backdrop fade in');
$('#x1, a.close').bind('click', function(){ $('#x1').attr('class', ''); $('#modalPanel-2').hide(); });
$('#modalid2').find('a').hide();
}
$('#ui-table-1 tr th:first').attr('class', '').html('');updateDataTable1();" listener="#{userAction.processValue}" process="@this" update="@form"/>
               <f:param value="#{row}" name="row"></f:param>
               <f:param name="startDate" value="#{tripList.startDate}"></f:param>
               </h:selectOneMenu>
              </p:column>
              <p:column headerText="Count" style="width:2%">
              <h:inputHidden value="#{tripList.count}" />
              <h:inputHidden value="#{tripList.countTemp}" id="tempCount"/>
              <h:inputHidden value="#{tripList.rideId}" />
              <h:inputHidden value="${tripList.memberCount}" />
              <span><h:outputText value="#{tripList.count}" rendered="#{tripList.rideId != 'NEW'}"/><h:outputText value="#{userAction.vehicleMasterDTO.capacity}" rendered="#{tripList.rideId == 'NEW'}"/></span>
              </p:column>
              </p:dataTable>
              <h:inputHidden value="${userAction.ridePreMatchTest}" id="ridePreMatchTest"/>
               <h:commandButton styleClass="btn btn-success" action="#{userAction.ridePreMatchTripLinking}" value="Link" rendered="#{not empty userAction.matchedTripByConditionList}" onclick="return linkingTest();"/>
             	<span class="modal-link-span-2" id="modalid2" style="display:none;">
             	<p:commandLink id="one" value="popupOne" rendered="#{not empty userAction.rideManagementListForPopupOne}" onclick="return false;" update="modalPanel-2-panel"></p:commandLink>
             	</span>
             
             <div id="x1" class=""> </div>
              
        <div id="modalPanel-2" class="modal hide fade in" style="display: none; ">
        	<div class="modal-header"><a class="close" data-dismiss="modal">×</a><h3>Vehicle Trips for the Day</h3></div>
        	<div class="modal-body">
        		<p:panel style="border: medium none;" id="modalPanel-2-panel">
					<div class="controls">
						<div class="well changer-green">
							<div id="ui-table-3">
							<ul class="smv-payment">
								<h:panelGrid columns="2">
								<li><b>Vehicle</b></li><h:outputText value="#{userAction.vehicleMasterDTO.reg_NO}"></h:outputText>
								<li><b>Make  Model</b></li> <h:outputText value="#{userAction.vehicleMasterDTO.make} #{userAction.vehicleMasterDTO.model}"></h:outputText>
								<li><b>Date</b></li> <h:outputText value="#{userAction.matchedTripDTO.startDate}"></h:outputText>
								</h:panelGrid>
							</ul> 
							</div>
						</div> 
					</div>
            
            		<div id="ui-table-1">
			             <p:dataTable rowIndexVar="row" value="#{userAction.rideManagementListForPopupOne}" var="one" rendered="#{not empty userAction.rideManagementListForPopupOne}">
			              <p:column >
			              <h:commandButton styleClass="btn btn-warning" value="#{one.rideID}" rendered="#{one.seatUsed ne userAction.vehicleMasterDTO.capacity}">
			              	<p:ajax listener="#{userAction.rideIdSetForLinking}" update="@form" oncomplete="modalUpdate();updateDataTable(); if($('#ui-table-1 tr th:first').length > 0) { $('#ui-table-1 tr th:first').attr('class', '').html(''); } xhr2(); xhr3(); " />	
			              	<f:param name="row" value="#{row}"></f:param>
		              		<f:param name="rideID" value="#{one.rideID}"></f:param>		              	
			              </h:commandButton>			              
			               <h:outputText rendered="#{one.seatUsed eq userAction.vehicleMasterDTO.capacity}" value="#{one.rideID}"></h:outputText>
			              </p:column>
			              <p:column headerText="From">
			              <h:outputText value="#{one.fromAddress1}"></h:outputText>
			              </p:column>
			               <p:column headerText="To">
			               <h:outputText value="#{one.toAddress1}"></h:outputText>
			              </p:column>
			               <p:column headerText="Time">
			               <h:outputText value="#{one.startdateValue}"></h:outputText>
			              </p:column>
			               <p:column headerText="Used Capacity">
			               <h:outputText rendered="#{empty one.seatUsed and one.seatUsed ne userAction.vehicleMasterDTO.capacity}" value="#{userAction.vehicleMasterDTO.capacity}" />
			              <h:outputText rendered="#{ not empty one.seatUsed and one.seatUsed ne userAction.vehicleMasterDTO.capacity}" value="#{one.seatUsed} of #{userAction.vehicleMasterDTO.capacity}"></h:outputText>
			              <h:outputText rendered="#{one.seatUsed eq userAction.vehicleMasterDTO.capacity}" value="No Seat Left"></h:outputText>
			              </p:column>
			              </p:dataTable>
              		</div>
              	</p:panel>
        	</div>
        </div> 
              </h:form>
              </div>
              </pm:content>
             
             	                           
        <div id="modalPanel-1" class="modal hide fade in" style="display: none; ">
        	<div class="modal-header"><a class="close" data-dismiss="modal">×</a><h3>Create Copy Of This Ride</h3></div>
        	<div class="modal-body">
        		<p:panel style="border: medium none;" id="modalPanel-1-panel">
        		<div class="controls">
	              <div class="well changer-green">
	                <ul class="smv-payment">
	                <h:panelGrid columns="2">
	                  <li><b>Vehicle</b></li><h:outputText value="#{userAction.vehicleMasterDTO.reg_NO}"></h:outputText>
	                  <li><b>Make  Model</b></li> <h:outputText value="#{userAction.vehicleMasterDTO.model} #{userAction.vehicleMasterDTO.model}"></h:outputText>
	                  <li><b>Date</b></li> <h:outputText value="#{userAction.matchedTripDTO.startDate}"></h:outputText>
	                  </h:panelGrid>
	                  </ul> 
	              </div>
	            </div>
	              
	              <div id="ui-table-2" style="display:block;"> 
	               <p:dataTable value="#{userAction.allSeekerForGivenRide}" var="ride">
	               <p:column headerText="Name">
	               <h:outputText value="#{ride.userName}"></h:outputText>
	               </p:column>
	               <p:column headerText="From">
	               <h:outputText value="#{ride.fromAddress1}"></h:outputText>
	               </p:column>
	               <p:column headerText="To">
	               <h:outputText value="#{ride.toAddress1}"></h:outputText>
	               </p:column>
	               <p:column headerText="Time">
	               <h:outputText value="#{ride.startdateValue}"></h:outputText>
	               </p:column>
	               
	               </p:dataTable>
	               </div>
	              </p:panel>
        	</div>
        </div> 
         
              
             
              </div>
                  <!-- <p>
                    <button class="btn btn-small" type="button">Edit</button>
                    <button class="btn btn-small btn-primary" type="button">Save</button>
                  </p> -->
                  
                  
            

			<div id="modalPanel-3" class="modal hide fade in" style="display: none;margin:-250px 0 0 -430px;width: 860px;">
        	<div class="modal-header"><a class="close" data-dismiss="modal">×</a><h3>Vehicle List</h3></div>
        	<div class="modal-body">
        		<p:panel style="border: medium none;" id="modalPanel-3-panel">
        			<c:if test="${not empty userAction.ridePreVehicleDate}">
				<c:if test="${userAction.ridePreVehicleList.size() gt 0}">
					<span class="muted lead"><h3>Vehicles detail for ${userAction.ridePreVehicleDate}.</h3></span>
					<table class="table table-bordered table-striped">
						<tr style="font-family: icon;font-size: 17px;font-weight: bold">
							<td width="14%">Vehicle</td>
							<td width="10%">Filled / Capacity</td>
							<td width="11%">Time</td>
							<td width="32%">From</td>
							<td width="32%">To</td>
						</tr>
						<c:forEach varStatus="loop" items="${userAction.ridePreVehicleList}" var="vehicle">
							<tr>
								<td>${vehicle.vehicleName}</td>
								<td>${vehicle.filled} / ${vehicle.capacity}</td>
								<td>${vehicle.date}</td>
								<td>${vehicle.from}</td>
								<td>${vehicle.to}</td>
							</tr>
						</c:forEach>
					</table>
	
				</c:if>
				<c:if test="${userAction.ridePreVehicleList.size() eq 0}">
				<span class="muted lead"><h3>No Vehicle is assigned on ${userAction.ridePreVehicleDate}.</h3></span>
				</c:if>
				</c:if>
           		${userAction.clearRidePreVehicleList()}
        		</p:panel>
        	</div>
        	</div>


												</pm:content>

			</c:when>
			<c:otherwise>
				<span class="span10 muted lead"><h3><h:outputText value="${msgs['error.permissionDenied']}"></h:outputText></h3></span>
			</c:otherwise> </c:choose>
			
                </div>
              </div>
            </div>
            <!-- table section ends here -->
          </div>
        </div>
      </div><br/><br/><br/><br/><br/><br/>
      <!-- End: MAIN CONTENT -->


	<ui:include src="../../pages/common/footer-content.xhtml"></ui:include>
 </h:body>

</pm:view>
</pm:page>
</f:view>
</html>

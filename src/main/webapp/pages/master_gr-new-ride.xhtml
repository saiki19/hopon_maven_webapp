<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
    xmlns:pm="http://primefaces.org/mobile"        
    contentType="text/html" renderKitId="PRIMEFACES_MOBILE">
  <f:view>     
        <pm:page>
<pm:view>
		<ui:include src="../../pages/common//headerScript.xhtml"></ui:include>
<!-- <c:set value="#{request.scheme}://#{request.serverName}#{request.contextPath}" property="url" var="url"/> -->

  <script type="text/javascript">
	
  	Date.prototype.format = function(format) {
		var o = {
		  "M+" : this.getMonth()+1, //month
		  "d+" : this.getDate(),    //day
		  "h+" : this.getHours(),   //hour
		  "m+" : this.getMinutes(), //minute
		  "s+" : this.getSeconds(), //second
		  "q+" : Math.floor((this.getMonth()+3)/3),  //quarter
		  "S" : this.getMilliseconds() //millisecond
		}

		if(/(y+)/.test(format)) format=format.replace(RegExp.$1,
		  (this.getFullYear()+"").substr(4 - RegExp.$1.length));
		for(var k in o)if(new RegExp("("+ k +")").test(format))
		  format = format.replace(RegExp.$1,
		    RegExp.$1.length==1 ? o[k] :
		      ("00"+ o[k]).substr((""+ o[k]).length));
		return format;
	}
                        
  	jQuery(document).ready(function(){
  		updatePart();
		googleLoc();
	});
 </script>
<script language="javascript" >
function updatePart() {
	$("#tab1\\:curentDate").datetimepicker({
		dateFormat : "dd M y,",
		timeFormat : "hh.mm TT",
		minDate : new Date(),
		onSelect : function(){
			var tempDate = $("#tab1\\:curentDate").datepicker("getDate");
			tempDate.setDate(tempDate.getDate() + 1);
			var maxDate = $("#tab1\\:curentDate").datepicker("getDate"); 
			maxDate.setDate(maxDate.getDate() + 61);
			$("#tab1\\:curentDate2").datepicker("option", "minDate", tempDate);
			$("#tab1\\:curentDate2").datepicker("option", "maxDate", maxDate);
		},
	});
	
	$("#tab1\\:curentDate2").datetimepicker({
		dateFormat : "dd M y,",
		timeFormat : "hh.mm TT",
		minDate : Date.parseString('#{userAction.minDate}','dd NNN yy, HH.mm a'),
	});
	var minDate = new Date(); minDate.setDate(minDate.getDate() + 1);
	var maxDate = new Date(); maxDate.setDate(maxDate.getDate() + 60);
	$("#tab1\\:curentDate2").datepicker("option", "minDate", minDate);
	$("#tab1\\:curentDate2").datepicker("option", "maxDate", maxDate);
	
	$("#tab1\\:fromcity, #tab1\\:frompin, #tab1\\:tocity, #tab1\\:topin").prop("readonly",true);

		
		if($('#tab1\\:recurring').is(':checked')) {
		$("#ifYes").show();
	} else {
		$("#ifYes").hide();
	}
	$('#tab1\\:recurring').click(function(){
		if($(this).is(':checked')) {
			var w = Date.parseString($("#tab1\\:curentDate").val(), 'dd NNN yy, HH.mm a');
			if(w != null) {
				currentTime = new Date(new Date().getFullYear(), new Date().getMonth(), new Date().getDate());
	    		currentTime.setDate(currentTime.getDate()+2);
	    		if(!(w >= currentTime)) $("#tab1\\:curentDate").val('');
			}
			currentTime = new Date();
    		currentTime.setDate(currentTime.getDate()+2);
    		
			$("#tab1\\:curentDate").datepicker("option", "minDate", currentTime);
			$("#ifYes").show();
		} else {
			$("#ifYes").hide();
			$("#tab1\\:curentDate").datepicker("option", "minDate", new Date());
		}
	});
}
function check(){
  document.getElementById('form:takeride').className += " btn btn-small btn-success";
}
</script>

<link rel="stylesheet" href="//code.jquery.com/ui/1.10.4/themes/smoothness/jquery-ui.css" />
 
   <script src="//code.jquery.com/jquery-1.9.1.js"></script>
<script src="//code.jquery.com/ui/1.10.4/jquery-ui.js"></script>


<script>

var x = jQuery.noConflict();
function googleLoc() { x(function() {
	x( "#tab1\\:fromaddress" ).autocomplete({
		source: function( request, response ) {
			$("#tab1\\:fromcity").val("");
	 		$("#tab1\\:frompin").val("");
			$("#tab1\\:startPoinLat").val("");
	 		$("#tab1\\:startPoinLng").val("");
			x.ajax({
				url: "http://maps.googleapis.com/maps/api/geocode/json",
				data: {
					sensor: false,
					address: request.term,
					components: 'country:IN',
				},
				success: function( data ) {
					var myAddress = new Array();
					for(var i in data.results){
						var city = "";
						var postal_code = "";
						for(var j in data.results[i]['address_components']) {
							for(var k in data.results[i]['address_components'][j]["types"]) {
								if(data.results[i]['address_components'][j]["types"][k] == "locality") {
									city = data.results[i]['address_components'][j]["long_name"];
									break;
								}
								if(data.results[i]['address_components'][j]["types"][k] == "postal_code") {
									postal_code = data.results[i]['address_components'][j]["long_name"];
									break;
								}
							}
						}
						//alert(city + "--" + postal_code);
						myAddress.push({
							'formatted_address' : data.results[i]['formatted_address'], 
							'lat' : data.results[i]['geometry']['location']['lat'], 
							'lng' : data.results[i]['geometry']['location']['lng'],
							'city' : city,
							'postal_code' : postal_code,
						});
					}
					//alert(myAddress);
					response( $.map( myAddress, function( item ) {
						return {
							label: item.formatted_address ,
							value: item.formatted_address,
							lat: item.lat,
							lng: item.lng,
							city: item.city,
							postal_code: item.postal_code,
						}
					}));
				}
			});
		},
		minLength: 2,
		select: function( event, ui ) {
			$("#tab1\\:fromcity").val(ui.item.city);
	 		$("#tab1\\:frompin").val(ui.item.postal_code);
			$("#tab1\\:startPoinLat").val(ui.item.lat);
	 		$("#tab1\\:startPoinLng").val(ui.item.lng);
		},
	});
	x( "#tab1\\:toaddress" ).autocomplete({
		source: function( request, response ) {
			$("#tab1\\:tocity").val("");
	 		$("#tab1\\:topin").val("");
			$("#tab1\\:endPoinLat").val("");
	 		$("#tab1\\:endPoinLng").val("");
			x.ajax({
				url: "http://maps.googleapis.com/maps/api/geocode/json",
				data: {
					sensor: false,
					address: request.term,
					components: 'country:IN',
				},
				success: function( data ) {
					var myAddress = new Array();
					for(var i in data.results){
						var city = "";
						var postal_code = "";
						for(var j in data.results[i]['address_components']) {
							for(var k in data.results[i]['address_components'][j]["types"]) {
								if(data.results[i]['address_components'][j]["types"][k] == "locality") {
									city = data.results[i]['address_components'][j]["long_name"];
									break;
								}
								if(data.results[i]['address_components'][j]["types"][k] == "postal_code") {
									postal_code = data.results[i]['address_components'][j]["long_name"];
									break;
								}
							}
						}
						//alert(city + "--" + postal_code);
						myAddress.push({
							'formatted_address' : data.results[i]['formatted_address'], 
							'lat' : data.results[i]['geometry']['location']['lat'], 
							'lng' : data.results[i]['geometry']['location']['lng'],
							'city' : city,
							'postal_code' : postal_code,
						});
					}
					//alert(myAddress);
					response( $.map( myAddress, function( item ) {
						return {
							label: item.formatted_address ,
							value: item.formatted_address,
							lat: item.lat,
							lng: item.lng,
							city: item.city,
							postal_code: item.postal_code,
						}
					}));
				}
			});
		},
		minLength: 2,
		select: function( event, ui ) {
			$("#tab1\\:tocity").val(ui.item.city);
	 		$("#tab1\\:topin").val(ui.item.postal_code);
			$("#tab1\\:endPoinLat").val(ui.item.lat);
	 		$("#tab1\\:endPoinLng").val(ui.item.lng);
		},
	});
 	
});
}
</script>
<script type="text/javascript">
 		/* 'tab1:fromaddress'
 		'tab1:toaddress'
 		
 		$("#tab1\\:fromcity_input").val("");
 		$("#tab1\\:frompin").val("");	
 		$("#tab1\\:startPoinLat").val("");
 		$("#tab1\\:startPoinLng").val("");

		$("#tab1\\:tocity").val("");
		$("#tab1\\:topin").val("");
 		$("#tab1\\:endPoinLat").val("");
 		$("#tab1\\:endPoinLng").val(""); */

    </script>
  <script type="text/javascript">
        function validate_rideSeeker() {
        	var startDate = Date.parseString($("#tab1\\:curentDate").val(), 'dd NNN yy, HH.mm a');
        	var endDate = Date.parseString($("#tab1\\:curentDate2").val(), 'dd NNN yy, HH.mm a');
        	var address1 = $("#tab1\\:fromaddress").val();
        	var address2 = $("#tab1\\:toaddress").val();
        	var recurring = $("#tab1\\:recurring").is(':checked');
        	var error = new Array();
        	if(startDate == null) error.push("Please select Start Date.");
        	if(recurring) if(endDate == null) error.push("Please select End Date.");
        	if($.trim(address1).length == 0) error.push("Please enter source address.");
        	if($.trim(address2).length == 0) error.push("Please enter destination address.");
        	if($("#tab1\\:vehicleId")) if(parseInt($("#tab1\\:vehicleId").val()) == 0) error.push("Please select Vehicle.");
        	if(recurring)  if(startDate > endDate) error.push("End date should be after start date.");
        	if(recurring)  if((endDate - startDate) > 1000*60*60*24*60) error.push("Recurring ride can be booked only for 2 months from the start date.");
       		
        	if(error.length > 0) {
	        	$("#errorMessage").show();
	        	$("#errorMessage").find(".form-message").html("");
	        	for(var i in error) {
	        		$("#errorMessage").find(".form-message").append(error[i]+"&lt;br>");
	        	}
        	} else {
        		$("#errorMessage").hide(); $("#errorMessage").find(".form-message").html("");
        		return true;
        	}
        	return false;
        }
        </script>  
<h:head></h:head>

<h:body>
	<ui:include src="../../pages/common/headerContent.xhtml"></ui:include>
  <!-- Start: MAIN CONTENT -->
  <div class="content">
    <div class="container">

      <div class="row">
        <!-- <div class="span2"></div>  bs-docs-sidenav affix nav-tabs nav-stacked-->
        <div class="span2">

          <div class="smv-leftnav">
          	<!-- Include leftPanel.xhtml -->
          	<ui:include src="../../pages/common/leftPanel.xhtml"></ui:include>
          </div>
        </div>
        <!-- table section -->
			<c:choose>  
			<c:when var="test" test="#{sessionScope.user_role == 'C' || sessionScope.user_role == 'P' || sessionScope.user_role == 'B'}">
         <pm:content>
         <span style="display:none">
          ${userAction.clearNewRide()}
          </span>
          <h:form id="tab1" styleClass="form-horizontal">
        
        <div class="span10">
        
			
          <div class="page-header">
            <h1>New Ride</h1>
          </div>
          	<p:messages id="messages" showDetail="false" autoUpdate="true"/>
          	<c:forEach var="errMessage" items="${userAction.errorMessage}">
				<div class="alert fade in alert-error" style="display:none;">
					<button class="close" data-dismiss="alert" type="button">×</button>
					<span class="form-message">${errMessage}</span>
				</div>
			</c:forEach>
			<div id="x3">
		<p:panel id="messagePanel" style="border:none;background:#FCFCFC;">		
			<c:forEach var="sucMessage" items="${userAction.successMessage}">
					<div class="alert fade in alert-success" syle="display:none;">
						<button class="close" data-dismiss="alert" type="button">×</button>
						<span class="form-message">${sucMessage}</span>
					</div>
			</c:forEach>
			<c:forEach var="errMessage" items="${userAction.errorMessage}">
					<div class="alert fade in alert-error" syle="display:none;">
						<button class="close" data-dismiss="alert" type="button">×</button>
						<span class="form-message">${errMessage}</span>
					</div>
			</c:forEach>	
			${userAction.clearScreenMessage()}
		</p:panel>	
			</div>
          <span style="display:none">
          ${userAction.clearScreenMessage()}
          </span>
			<div class="row"><div class="span8">
			<div class="alert fade in alert-error" style="display:none;" id="errorMessage">
				<span class="form-message"></span>
			</div></div></div>
       
          <div>
            <div class="row">
              <div class="span4 ">
              
               <div class="well changer" style="height: 125px;">
					<div class="control-group">
						<label class="control-label" for="inputPassword"><b> Trip date/time</b></label>
						<div class="controls">                                                
							<h:inputText id="curentDate"  value="#{userAction.rideRegistered.startDate1}"/>
						</div>
					</div>					
					<div class="control-group">
                    	<label class="control-label" for="custom"><b><h:outputLabel value="Custom" rendered="#{sessionScope.user_role == 'C' || sessionScope.user_role == 'B'}" /> </b></label>
                    	<div class="controls" style="display: inline-block;margin-left: 8px;"> &nbsp;
                        	<h:inputText id="custom"  value="#{userAction.rideRegistered.custom}" rendered="#{sessionScope.user_role == 'C' || sessionScope.user_role == 'B'}"/>
                      	</div>
					</div>
					<div class="control-group">
                    	<label class="control-label" for="inputPassword"><b><h:outputLabel value="My Vehicles" rendered="#{(userAction.ridePicker ==2 and userAction.userRegistrationDTO.travel eq 'B') or (userAction.userRegistrationDTO.travel eq 'P')}" /> </b></label>
                    	<div class="controls" style="display: inline-block;margin-left: 8px;"> &nbsp;
                        	<h:selectOneMenu id="vehicleId" rendered="#{(userAction.ridePicker ==2 and userAction.userRegistrationDTO.travel eq 'B') or (userAction.userRegistrationDTO.travel eq 'P')}"  value="#{userAction.rideRegistered.vehicleID}" >
                        		<f:selectItems  value="#{userAction.allVehicleList}"></f:selectItems>
                        	</h:selectOneMenu>
                      	</div>
					</div>
				</div>
                <div class="well changer">
                    <p><strong>Address From</strong></p>
                    <div class="control-group">
                      <label class="control-label" for="inputEmail">Address Tag</label>
                      <div class="controls">
                      <h:selectOneMenu id="from" value="#{userAction.rideRegistered.fromAddressTag}"  >
                      
                      <f:selectItem itemLabel="New" itemValue="new"></f:selectItem>
                       <f:selectItems value="#{userAction.allPlacesList}" />
                        <p:ajax  listener="#{userAction.processValueChange}" process="@this,from" update="fromaddress,fromcity,frompin,startPoinLat,startPoinLng" oncomplete="googleLoc();"/>
                       </h:selectOneMenu>
                      </div>
                    </div>
                    <!-- <div class="control-group">
                      <label class="control-label" for="inputEmail">Address1</label>
                      <div class="controls">
                        <input type="text" id="inputEmail" placeholder="Address1">
                      </div>
                    </div> -->
                    <div class="control-group">
                      <label class="control-label" for="inputPassword">Address1</label>
                      <div class="controls">
                        <h:inputText id="fromaddress" value="#{userAction.rideRegistered.fromAddress1}" />
                      </div>
                    </div>
                    <div class="control-group">
                      <label class="control-label" for="inputEmail">City</label>
                      <div class="controls">
                        <h:inputText id="fromcity" value="#{userAction.rideRegistered.fromAddressCity}"/>
                      </div>
                    </div>
                    <div class="control-group">
                      <label class="control-label" for="inputPassword">Pin</label>
                      <div class="controls">
                        <h:inputText id="frompin" value="#{userAction.rideRegistered.fromAddressPin}"/>
                      	<h:inputHidden id="startPoinLat" value="#{userAction.rideRegistered.startPointLatitude}"/>
                      	<h:inputHidden id="startPoinLng" value="#{userAction.rideRegistered.startPointLongitude}"/>
                      </div>
                    </div>
                  
                    <div class="control-group">
                      <label class="control-label" for="inputPassword">Tag (20 limit)</label>
                      <div class="controls">
                         <h:inputText value="#{userAction.rideRegistered.fromAddressTagLimit}" />
                      </div>
                    </div>
                 
                </div>
                <!-- for lower -->
                <pm:content rendered="#{true}">
                <div class="well changer" style="height:auto">
                  <p><strong>Recurring</strong> 
                         <h:selectBooleanCheckbox id="recurring"  value="#{userAction.recurring}" styleClass="input-xlarge">
   	                      <!-- <f:ajax event="click" render="@form" />  -->
   	                     </h:selectBooleanCheckbox></p>
   	               
                  <div id="ifYes" style="display:none;">
                    
                    <div class="control-group">
                      <label class="control-label" for="inputEmail">Frequency</label>
                      <div class="controls">
                       
                      <p:selectManyCheckbox columns="4" layout="grid" style="width:100px;"   value="#{userAction.frequencyDTO.frequency}" >
                   
                      <f:selectItem itemLabel="Mon" itemValue="Mon" />  
                      <f:selectItem itemLabel="Tue" itemValue="Tue" />  
                      <f:selectItem itemLabel="Wed" itemValue="Wed" />  
                      <f:selectItem itemLabel="Thu" itemValue="Thu" />  
                      <f:selectItem itemLabel="Fri" itemValue="Fri" />  
                      <f:selectItem itemLabel="Sat" itemValue="Sat" />
                      <f:selectItem itemLabel="Sun" itemValue="Sun" />  
                      
                      </p:selectManyCheckbox>
                        
                      </div>
                    </div>
                     <div class="control-group">
                      <label class="control-label" for="inputPassword">End Date</label>
                     
						<div class="controls">
                        	<h:inputText id="curentDate2"  value="#{userAction.rideRegistered.endDate1}" />
                      	</div>
                        
                    </div>                    
                    </div>
                </div>
                </pm:content>
                <!-- end of lower -->
              </div>
              <!-- div for other one form -->
              <div class="span4 ">
              
              <pm:content rendered="#{(userAction.userRegistrationDTO.travel == 'B') or userAction.userRegistrationDTO.travel == 'C'}">
               <div class="well changer" style="height: 125px;">
                    <div class="control-group">
                    	<div style="margin-bottom: 22px;padding: 7px 1px;">
                    	<pm:content rendered="#{(userAction.userRegistrationDTO.travel == 'B' and userAction.ridePicker ==1) or userAction.userRegistrationDTO.travel == 'C'}">
						<span style="margin-right:35px;"><h:selectBooleanCheckbox value="#{userAction.rideRegistered.sharedTaxi}" id="carpool"/> Carpool&nbsp;</span>
						</pm:content>
                    	<h:selectBooleanCheckbox  id="checkboxes-0" value="#{userAction.rideRegistered.automatchInCircle}"  /> Auto Match - In circle only 
                    	</div>
                      	
                       <pm:content rendered="#{(userAction.userRegistrationDTO.travel == 'B' and userAction.ridePicker ==1) or userAction.userRegistrationDTO.travel == 'C'}">
						<label class="control-label" style="width: 86px;">Exp. Code / Mgr</label>
						<div class="controls">
						${userAction.populateApprover()}
						<h:selectOneListbox value="#{userAction.rideRegistered.approverID}" size="1" style="margin-left: 9px;width: 71%">
							<f:selectItem itemLabel="Select Approver" itemValue=""/>
							<c:forEach var="approver" items="#{userAction.approverdtoList}">
							<f:selectItem itemLabel="${approver.bCode} - ${approver.name}" itemValue="${approver.id}" />
							</c:forEach>
						</h:selectOneListbox>
						</div>
						</pm:content>
                                    
                    </div>
                      </div>
               </pm:content>
                <div class="well changer">

                    <!-- Form Name -->
                    
                    <p><strong>Address To</strong> &nbsp; 
                      
                    </p>
                    <div class="control-group">
                      <label class="control-label" for="inputEmail">Address Tag</label>
                      <div class="controls">
                      <h:selectOneMenu id="to" value="#{userAction.rideRegistered.toAddressTag}"  >
                      
                      <f:selectItem itemLabel="New" itemValue="new"></f:selectItem>
                       <f:selectItems value="#{userAction.allPlacesList}" />
                        <p:ajax  listener="#{userAction.processValueChange1}" process="@this,to" update="toaddress,tocity,topin,endPoinLat,endPoinLng" oncomplete="googleLoc();"/>
                       </h:selectOneMenu>
                      </div>
                    </div>
                    <div class="control-group">
                      <label class="control-label" for="inputEmail">Address1</label>
                      <div class="controls">
                        <h:inputText id="toaddress" value="#{userAction.rideRegistered.toAddress1}" />
                      </div>
                    </div>
                    <!-- <div class="control-group">
                      <label class="control-label" for="inputPassword">Address1</label>
                      <div class="controls">
                        <input type="password" id="inputPassword" placeholder="Address1">
                      </div>
                    </div> -->
                    <div class="control-group">
                      <label class="control-label" for="inputEmail">City</label>
                      <div class="controls">
                        <h:inputText id="tocity" value="#{userAction.rideRegistered.toAddressCity}" />
                      </div>
                    </div>
                    <div class="control-group">
                      <label class="control-label" for="inputPassword">Pin</label>
                      <div class="controls">
                         	<h:inputText id="topin" value="#{userAction.rideRegistered.toAddressPin}"/>
							<h:inputHidden id="endPoinLat" value="#{userAction.rideRegistered.endPointLatitude}"/>
                      		<h:inputHidden id="endPoinLng" value="#{userAction.rideRegistered.endPointLongitude}"/>
                      </div>
                    </div>
                   
                    <div class="control-group">
                      <label class="control-label" for="inputPassword">Tag (20 limit)</label>
                      <div class="controls">
                        <h:inputText value="#{userAction.rideRegistered.toAddressTagLimit}" />
                      </div>
                    </div>
                </div>
                <!-- for lower -->
                 <div class="well changer" style="height:150px;display:none;">
                  
                    <p><strong>Flexibility (Time) </strong></p>
                    
                    <!--  -->
                    ${userAction.userRatingUpdate()}
                       <script type="text/javascript">
			jQuery(document).ready(function(){
			var val = '#{userAction.userRegistrationDTO.defaultTimeSlice}';
		if(val.length > 5) {
		val = val.substring(0, 5);
		}
		$("#tab1\\:before_input").val(val);
		$("#tab1\\:after_input").val(val);
});
</script>
        
                    <div class="control-group">
                      <label class="control-label" for="inputPassword">Time before</label>
                       <div class="controls">
                        <p:calendar  id="before" value="#{userAction.rideRegistered.flexiTimeBefore}" pattern="HH:mm" timeOnly="true" label="00:30"></p:calendar>
                      </div>
                    </div>
                 
                    <div class="control-group">
                      <label class="control-label" for="inputPassword">Time After</label>
                       <div class="controls">
                        <p:calendar id="after" value="#{userAction.rideRegistered.flexiTimeAfter}" pattern="HH:mm"  timeOnly="true"></p:calendar>
                      </div>
                    </div>
                                     
                </div>
                
                <!-- end of lower -->
              </div>
            
          </div>
        </div>
        <p>
          <h:commandButton rendered="#{sessionScope.user_role == 'P' || (sessionScope.user_role == 'B' and userAction.ridePicker ==2)}" styleClass="btn btn-large btn-success" value="Register">
          	<f:param value="giveRide" name="ride"></f:param>
			<p:ajax process="@form" listener="#{userAction.registerRide}" update="@form" oncomplete="googleLoc();updatePart();" onsuccess="setTimeout(function(){ var url = $(location).attr('href');
			url=url.split('/')[0]+'//'+url.split('/')[2]+'/'+url.split('/')[3];
			alert(''+url);
          		if(parseInt($('#x3').find('span.form-message').length) == 0) 
          		 window.location =url+'/pages/rides/master-gr-pending-trips.xhtml'; }, 500);"/>          	
          </h:commandButton> &nbsp;
          <h:commandButton onclick="return validate_rideSeeker();" rendered="#{sessionScope.user_role == 'C' || (sessionScope.user_role == 'B' and userAction.ridePicker ==1)}" styleClass="btn btn-large btn-success" value="Register">
          	<f:param value="takeRide" name="ride"></f:param>
          	<p:ajax process="@form" listener="#{userAction.registerRide}" update="@form" oncomplete="googleLoc();updatePart();" onsuccess="setTimeout(function(){ 
          	var url = $(location).attr('href');
			url=url.split('/')[0]+'//'+url.split('/')[2]+'/'+url.split('/')[3];
			alert(''+url);
          		if(parseInt($('#x3').find('span.form-message').length) == 0) 
          		 window.location =url+'/pages/rides/master-gr-pending-trips.xhtml'; }, 500);"/>
          </h:commandButton> &nbsp;
          <h:commandButton styleClass="btn btn-large btn-danger" value="Clear"><p:ajax listener="#{userAction.clearNewRide}" update="@form"/></h:commandButton> &nbsp;
        
         </p>

        <!-- table section ends here -->
			
      </div>
      </h:form>
      </pm:content>
			</c:when>
			<c:otherwise>
				<span class="span10 muted lead"><h3><h:outputText value="${msgs['error.permissionDenied']}"></h:outputText></h3></span>
			</c:otherwise> </c:choose>
    </div>
    
  </div></div><br/><br/><br/><br/>
  <!-- End: MAIN CONTENT -->

	<ui:include src="../../pages/common/footer-content.xhtml"></ui:include>

</h:body>
</pm:view>
</pm:page>
</f:view>

</html>
